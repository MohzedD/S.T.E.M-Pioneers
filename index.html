<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S.T.E.M Pioneers Database</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --black-900: #000000;
            --black-800: #0a0a0a;
            --black-700: #0f0f0f;
            --black-600: #141414;
            --black-500: #1a1a1a;
            --black-400: #222222;
            --black-300: #2a2a2a;
            --blue-800: #0a1628;
            --blue-700: #0d1f3c;
            --blue-600: #102a4c;
            --blue-500: #1a365d;
            --orange-500: #ff6b00;
            --orange-400: #ff8534;
            --orange-300: #ff9f5a;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --cat-images: #22c55e;
            --cat-videos: #ef4444;
            --cat-audio: #a855f7;
            --cat-documents: #3b82f6;
            --cat-archives: #f59e0b;
            --cat-code: #06b6d4;
            --cat-other: #6b7280;
            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-tertiary: #71717a;
            --text-muted: #52525b;
            --border-primary: #27272a;
            --border-secondary: #3f3f46;
            --shadow-glow: 0 0 30px rgba(255, 107, 0, 0.3);
            --shadow-glow-sm: 0 0 15px rgba(255, 107, 0, 0.2);
            --gradient-orange: linear-gradient(135deg, #ff6b00, #ea580c);
            --gradient-dark: linear-gradient(180deg, #141414, #0a0a0a);
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        html { font-size: 16px; scroll-behavior: smooth; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--black-800);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
        }

        a { text-decoration: none; color: inherit; }
        button { font-family: inherit; cursor: pointer; border: none; background: none; outline: none; }
        input { font-family: inherit; outline: none; border: none; background: none; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--black-700); }
        ::-webkit-scrollbar-thumb { background: var(--black-300); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--black-200); }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: var(--black-900);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loading-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }

        .loader-content { text-align: center; }

        .hexagon-loader { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }

        .hexagon {
            width: 20px; height: 20px;
            background: var(--orange-500);
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            animation: hexPulse 1.5s ease-in-out infinite;
        }

        .hexagon:nth-child(2) { animation-delay: 0.2s; }
        .hexagon:nth-child(3) { animation-delay: 0.4s; }

        @keyframes hexPulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.3); opacity: 1; }
        }

        .loader-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: 6px;
            background: linear-gradient(135deg, var(--orange-500), var(--orange-300));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .loader-subtitle {
            color: var(--text-secondary);
            font-size: 0.875rem;
            letter-spacing: 2px;
            margin-bottom: 30px;
        }

        .loader-bar {
            width: 200px; height: 3px;
            background: var(--black-500);
            border-radius: 3px;
            overflow: hidden;
            margin: 0 auto;
        }

        .loader-progress {
            width: 0%; height: 100%;
            background: var(--gradient-orange);
            border-radius: 3px;
            animation: loadProgress 2s ease forwards;
        }

        @keyframes loadProgress { to { width: 100%; } }

        /* App Container */
        .app-container { display: flex; min-height: 100vh; }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            left: 0; top: 0;
            background: var(--gradient-dark);
            border-right: 1px solid var(--border-primary);
            display: flex;
            flex-direction: column;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-primary);
        }

        .logo { display: flex; align-items: center; gap: 12px; }

        .logo-icon {
            width: 50px; height: 50px;
            background: var(--gradient-orange);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: var(--shadow-glow-sm);
        }

        .logo-text { display: flex; flex-direction: column; }

        .logo-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            font-weight: 800;
            letter-spacing: 2px;
            color: var(--orange-500);
            line-height: 1.2;
        }

        .logo-subtitle {
            font-size: 0.6rem;
            font-weight: 600;
            letter-spacing: 3px;
            color: var(--text-secondary);
        }

        .sidebar-nav { flex: 1; overflow-y: auto; padding: 15px 0; }

        .nav-section { padding: 10px 20px; }

        .nav-section-title {
            font-size: 0.6rem;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 12px;
            display: block;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            border-radius: 10px;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            margin-bottom: 4px;
        }

        .nav-link:hover { background: var(--black-400); color: var(--text-primary); }

        .nav-link.active {
            background: linear-gradient(135deg, rgba(255, 107, 0, 0.15), rgba(255, 107, 0, 0.05));
            color: var(--orange-500);
            border: 1px solid rgba(255, 107, 0, 0.3);
        }

        .nav-link-icon {
            width: 36px; height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--black-500);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .nav-link-icon.images { color: var(--cat-images); }
        .nav-link-icon.videos { color: var(--cat-videos); }
        .nav-link-icon.audio { color: var(--cat-audio); }
        .nav-link-icon.documents { color: var(--cat-documents); }
        .nav-link-icon.archives { color: var(--cat-archives); }
        .nav-link-icon.code { color: var(--cat-code); }
        .nav-link-icon.other { color: var(--cat-other); }

        .nav-link-text { flex: 1; font-size: 0.9rem; font-weight: 500; }

        .nav-link-badge {
            background: var(--black-400);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-tertiary);
        }

        .nav-link.active .nav-link-badge {
            background: rgba(255, 107, 0, 0.2);
            color: var(--orange-500);
        }

        /* Sidebar Footer */
        .sidebar-footer { padding: 20px; border-top: 1px solid var(--border-primary); }

        .storage-widget {
            background: var(--black-500);
            border-radius: 12px;
            padding: 15px;
        }

        .storage-header { display: flex; justify-content: space-between; margin-bottom: 10px; }
        .storage-title { font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); }
        .storage-percentage { font-size: 0.75rem; font-weight: 700; color: var(--orange-500); }

        .storage-bar {
            height: 6px;
            background: var(--black-400);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .storage-bar-fill {
            height: 100%;
            background: var(--gradient-orange);
            border-radius: 3px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .storage-info { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-tertiary); }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header */
        .top-header {
            height: var(--header-height);
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-primary);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 30px;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .header-left { display: flex; align-items: center; gap: 20px; }

        .mobile-menu-btn {
            display: none;
            width: 40px; height: 40px;
            align-items: center;
            justify-content: center;
            background: var(--black-500);
            border-radius: 8px;
            color: var(--text-secondary);
        }

        .page-info h1 { font-size: 1.4rem; font-weight: 700; color: var(--text-primary); margin-bottom: 2px; }
        .page-info p { font-size: 0.8rem; color: var(--text-tertiary); }

        .header-center { flex: 1; max-width: 450px; margin: 0 30px; }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--black-600);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 12px 18px;
            gap: 12px;
            transition: all 0.2s ease;
        }

        .search-box:focus-within {
            border-color: var(--orange-500);
            box-shadow: 0 0 0 3px rgba(255, 107, 0, 0.1);
        }

        .search-box i { color: var(--text-tertiary); }
        .search-box input { flex: 1; color: var(--text-primary); font-size: 0.9rem; }
        .search-box input::placeholder { color: var(--text-muted); }

        .header-right { display: flex; align-items: center; gap: 12px; }

        .header-btn {
            width: 44px; height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--black-500);
            border: 1px solid var(--border-primary);
            border-radius: 10px;
            color: var(--text-secondary);
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .header-btn:hover { background: var(--black-400); color: var(--text-primary); }

        .upload-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 24px;
            background: var(--gradient-orange);
            border-radius: 10px;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: var(--shadow-glow-sm);
            transition: all 0.2s ease;
        }

        .upload-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-glow); }

        /* Content Wrapper */
        .content-wrapper { flex: 1; padding: 30px; }

        /* Upload Zone */
        .upload-zone {
            background: linear-gradient(145deg, var(--black-600), var(--black-700));
            border: 2px dashed var(--border-secondary);
            border-radius: 20px;
            padding: 50px 40px;
            text-align: center;
            margin-bottom: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-zone:hover, .upload-zone.dragover {
            border-color: var(--orange-500);
            background: linear-gradient(145deg, var(--black-500), var(--black-600));
        }

        .upload-zone-icon { font-size: 3.5rem; color: var(--orange-500); margin-bottom: 20px; }
        .upload-zone h2 { font-size: 1.4rem; font-weight: 600; margin-bottom: 10px; }
        .upload-zone p { color: var(--text-tertiary); margin-bottom: 20px; }

        .upload-features { display: flex; justify-content: center; gap: 25px; flex-wrap: wrap; }
        .upload-features span { display: flex; align-items: center; gap: 8px; font-size: 0.85rem; color: var(--text-secondary); }
        .upload-features i { color: var(--orange-500); }

        /* Toolbar */
        .content-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .toolbar-left { display: flex; align-items: center; gap: 15px; }
        .toolbar-left h2 { font-size: 1.4rem; font-weight: 700; }
        .file-count { font-size: 0.9rem; color: var(--text-tertiary); }

        .toolbar-right { display: flex; align-items: center; gap: 12px; }

        .view-options { display: flex; background: var(--black-600); border-radius: 10px; padding: 4px; }

        .view-btn {
            width: 38px; height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            color: var(--text-tertiary);
            transition: all 0.2s ease;
        }

        .view-btn:hover { color: var(--text-secondary); }
        .view-btn.active { background: var(--black-400); color: var(--orange-500); }

        .sort-select {
            background: var(--black-600);
            border: 1px solid var(--border-primary);
            border-radius: 10px;
            padding: 10px 16px;
            color: var(--text-secondary);
            font-size: 0.875rem;
            cursor: pointer;
        }

        .sort-select:focus { border-color: var(--orange-500); outline: none; }

        /* Files Grid */
        .files-grid { display: grid; gap: 20px; }
        .files-grid.grid-view { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); }
        .files-grid.list-view { grid-template-columns: 1fr; }

        /* File Card */
        .file-card {
            background: linear-gradient(145deg, var(--black-500), var(--black-700));
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .file-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0;
            height: 3px;
            background: var(--gradient-orange);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .file-card:hover {
            transform: translateY(-5px);
            border-color: var(--border-secondary);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .file-card:hover::before { opacity: 1; }

        .file-preview {
            height: 150px;
            background: var(--black-700);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .file-preview img {
            width: 100%; height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .file-card:hover .file-preview img { transform: scale(1.05); }

        .file-preview video { width: 100%; height: 100%; object-fit: cover; }

        .file-preview .file-icon { font-size: 3rem; color: var(--black-300); }
        .file-preview .file-icon.images { color: var(--cat-images); }
        .file-preview .file-icon.videos { color: var(--cat-videos); }
        .file-preview .file-icon.audio { color: var(--cat-audio); }
        .file-preview .file-icon.documents { color: var(--cat-documents); }
        .file-preview .file-icon.archives { color: var(--cat-archives); }
        .file-preview .file-icon.code { color: var(--cat-code); }

        .file-badge {
            position: absolute;
            top: 10px; right: 10px;
            background: rgba(0, 0, 0, 0.75);
            backdrop-filter: blur(10px);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .file-favorite {
            position: absolute;
            top: 10px; left: 10px;
            width: 32px; height: 32px;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            opacity: 0;
            transition: all 0.2s ease;
        }

        .file-card:hover .file-favorite { opacity: 1; }
        .file-favorite:hover, .file-favorite.active { color: var(--warning); }

        .file-info { padding: 16px; }

        .file-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 8px;
        }

        .file-meta { display: flex; justify-content: space-between; align-items: center; }
        .file-size { font-size: 0.75rem; color: var(--text-tertiary); }
        .file-date { font-size: 0.7rem; color: var(--text-muted); }

        /* List View */
        .files-grid.list-view .file-card { display: flex; align-items: center; padding: 14px; }

        .files-grid.list-view .file-preview {
            width: 55px; height: 55px;
            min-width: 55px;
            border-radius: 10px;
            margin-right: 14px;
        }

        .files-grid.list-view .file-preview .file-icon { font-size: 1.5rem; }
        .files-grid.list-view .file-badge { position: static; margin-left: auto; margin-right: 15px; }
        .files-grid.list-view .file-favorite { position: static; margin-right: 14px; opacity: 1; }
        .files-grid.list-view .file-info { flex: 1; padding: 0; display: flex; align-items: center; }
        .files-grid.list-view .file-name { flex: 1; margin: 0; margin-right: 25px; }
        .files-grid.list-view .file-meta { gap: 35px; }

        /* Empty State */
        .empty-state {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 70px 40px;
            text-align: center;
        }

        .empty-state.show { display: flex; }

        .empty-state-icon {
            width: 120px; height: 120px;
            background: var(--black-600);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 25px;
            position: relative;
        }

        .empty-state-icon::before {
            content: '';
            position: absolute;
            inset: -8px;
            border: 2px dashed var(--border-secondary);
            border-radius: 50%;
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate { to { transform: rotate(360deg); } }

        .empty-state-icon i { font-size: 3rem; color: var(--text-muted); }
        .empty-state h2 { font-size: 1.5rem; font-weight: 600; margin-bottom: 10px; }
        .empty-state p { color: var(--text-tertiary); max-width: 350px; margin-bottom: 25px; }

        .empty-upload-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            background: var(--gradient-orange);
            border-radius: 12px;
            color: white;
            font-weight: 600;
            box-shadow: var(--shadow-glow-sm);
            transition: all 0.2s ease;
        }

        .empty-upload-btn:hover { transform: translateY(-2px); box-shadow: var(--shadow-glow); }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.show { opacity: 1; visibility: visible; }

        .file-modal {
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            width: 90%;
            max-width: 850px;
            max-height: 85vh;
            background: var(--black-700);
            border: 1px solid var(--border-primary);
            border-radius: 20px;
            z-index: 201;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .file-modal.show { opacity: 1; visibility: visible; transform: translate(-50%, -50%) scale(1); }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px 22px;
            border-bottom: 1px solid var(--border-primary);
            background: var(--black-600);
        }

        .modal-title { display: flex; align-items: center; gap: 12px; font-size: 1rem; font-weight: 600; }
        .modal-title i { color: var(--orange-500); }

        .modal-actions { display: flex; gap: 8px; }

        .modal-btn {
            width: 38px; height: 38px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--black-500);
            border-radius: 8px;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }

        .modal-btn:hover { background: var(--black-400); color: var(--text-primary); }
        .modal-btn.close:hover { background: var(--error); }

        .modal-body { display: flex; flex: 1; overflow: hidden; }

        .preview-section {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 35px;
            background: var(--black-800);
            min-height: 300px;
        }

        .preview-section img { max-width: 100%; max-height: 50vh; border-radius: 10px; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4); }
        .preview-section video { max-width: 100%; max-height: 50vh; border-radius: 10px; }
        .preview-section audio { width: 100%; max-width: 350px; }

        .preview-placeholder { text-align: center; }
        .preview-placeholder i { font-size: 5rem; color: var(--black-300); margin-bottom: 15px; display: block; }
        .preview-placeholder p { color: var(--text-tertiary); }

        .details-section {
            width: 280px;
            border-left: 1px solid var(--border-primary);
            display: flex;
            flex-direction: column;
            background: var(--black-700);
        }

        .details-content { flex: 1; padding: 22px; overflow-y: auto; }

        .detail-group { margin-bottom: 18px; }
        .detail-label { font-size: 0.65rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; color: var(--text-muted); margin-bottom: 5px; }
        .detail-value { font-size: 0.9rem; color: var(--text-primary); word-break: break-all; }

        .modal-footer { padding: 18px 22px; border-top: 1px solid var(--border-primary); display: flex; gap: 10px; }

        .action-btn {
            flex: 1;
            padding: 11px;
            border-radius: 10px;
            font-size: 0.85rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .action-btn.secondary { background: var(--black-500); color: var(--text-primary); }
        .action-btn.secondary:hover { background: var(--black-400); }
        .action-btn.danger { background: rgba(239, 68, 68, 0.15); color: var(--error); }
        .action-btn.danger:hover { background: var(--error); color: white; }

        /* Context Menu */
        .context-menu {
            position: fixed;
            background: var(--black-600);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 8px;
            min-width: 170px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            z-index: 300;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.95);
            transition: all 0.15s ease;
        }

        .context-menu.show { opacity: 1; visibility: visible; transform: scale(1); }

        .context-item {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            padding: 10px 14px;
            border-radius: 8px;
            color: var(--text-secondary);
            font-size: 0.85rem;
            transition: all 0.15s ease;
        }

        .context-item:hover { background: var(--black-400); color: var(--text-primary); }
        .context-item.danger:hover { background: var(--error); }
        .context-divider { height: 1px; background: var(--border-primary); margin: 8px 0; }

        /* Toast */
        .toast-container {
            position: fixed;
            bottom: 25px; right: 25px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 400;
        }

        .toast {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--black-600);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            padding: 14px 18px;
            min-width: 280px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            animation: toastIn 0.3s ease;
        }

        .toast.hide { animation: toastOut 0.3s ease forwards; }

        @keyframes toastIn { from { opacity: 0; transform: translateX(100%); } to { opacity: 1; transform: translateX(0); } }
        @keyframes toastOut { from { opacity: 1; transform: translateX(0); } to { opacity: 0; transform: translateX(100%); } }

        .toast-icon { width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .toast.success .toast-icon { background: rgba(16, 185, 129, 0.15); color: var(--success); }
        .toast.error .toast-icon { background: rgba(239, 68, 68, 0.15); color: var(--error); }
        .toast.warning .toast-icon { background: rgba(245, 158, 11, 0.15); color: var(--warning); }

        .toast-content { flex: 1; }
        .toast-title { font-size: 0.85rem; font-weight: 600; margin-bottom: 2px; }
        .toast-message { font-size: 0.75rem; color: var(--text-secondary); }

        /* Upload Panel */
        .upload-panel {
            position: fixed;
            bottom: 25px; right: 25px;
            width: 360px;
            background: var(--black-600);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
        }

        .upload-panel.show { opacity: 1; visibility: visible; transform: translateY(0); }

        .upload-panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            border-bottom: 1px solid var(--border-primary);
        }

        .upload-panel-title { display: flex; align-items: center; gap: 10px; font-weight: 600; font-size: 0.9rem; }
        .upload-panel-title i { color: var(--orange-500); }

        .upload-panel-close {
            width: 28px; height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            color: var(--text-tertiary);
            transition: all 0.2s ease;
        }

        .upload-panel-close:hover { background: var(--black-400); color: var(--text-primary); }

        .upload-panel-body { max-height: 220px; overflow-y: auto; padding: 10px; }

        .upload-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--black-500);
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .upload-item:last-child { margin-bottom: 0; }

        .upload-item-icon {
            width: 38px; height: 38px;
            background: var(--black-400);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--orange-500);
        }

        .upload-item-info { flex: 1; min-width: 0; }
        .upload-item-name { font-size: 0.8rem; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 6px; }

        .upload-item-bar { height: 4px; background: var(--black-400); border-radius: 2px; overflow: hidden; }
        .upload-item-progress { height: 100%; background: var(--gradient-orange); border-radius: 2px; transition: width 0.3s ease; }

        .upload-item-status { font-size: 1.1rem; }
        .upload-item-status.success { color: var(--success); }
        .upload-item-status.error { color: var(--error); }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-left: 0; }
            .mobile-menu-btn { display: flex; }
            .header-center { display: none; }
            .details-section { display: none; }
            .file-modal { max-width: 95%; }
        }

        @media (max-width: 768px) {
            .content-wrapper { padding: 20px; }
            .upload-zone { padding: 35px 20px; }
            .files-grid.grid-view { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }
            .file-preview { height: 120px; }
            .toolbar-left h2 { font-size: 1.2rem; }
            .upload-btn span { display: none; }
            .upload-panel { left: 15px; right: 15px; width: auto; }
            .toast-container { left: 15px; right: 15px; }
            .toast { min-width: auto; }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <div class="loader-content">
            <div class="hexagon-loader">
                <div class="hexagon"></div>
                <div class="hexagon"></div>
                <div class="hexagon"></div>
            </div>
            <h1 class="loader-title">S.T.E.M PIONEERS</h1>
            <p class="loader-subtitle">Initializing Database...</p>
            <div class="loader-bar">
                <div class="loader-progress"></div>
            </div>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-atom"></i>
                    </div>
                    <div class="logo-text">
                        <span class="logo-title">S.T.E.M</span>
                        <span class="logo-subtitle">PIONEERS DATABASE</span>
                    </div>
                </div>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <span class="nav-section-title">Library</span>
                    <a href="#" class="nav-link active" data-category="all">
                        <div class="nav-link-icon"><i class="fas fa-layer-group"></i></div>
                        <span class="nav-link-text">All Files</span>
                        <span class="nav-link-badge" id="count-all">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="favorites">
                        <div class="nav-link-icon"><i class="fas fa-star"></i></div>
                        <span class="nav-link-text">Favorites</span>
                        <span class="nav-link-badge" id="count-favorites">0</span>
                    </a>
                </div>

                <div class="nav-section">
                    <span class="nav-section-title">Categories</span>
                    <a href="#" class="nav-link" data-category="images">
                        <div class="nav-link-icon images"><i class="fas fa-image"></i></div>
                        <span class="nav-link-text">Images</span>
                        <span class="nav-link-badge" id="count-images">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="videos">
                        <div class="nav-link-icon videos"><i class="fas fa-play-circle"></i></div>
                        <span class="nav-link-text">Videos</span>
                        <span class="nav-link-badge" id="count-videos">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="audio">
                        <div class="nav-link-icon audio"><i class="fas fa-headphones"></i></div>
                        <span class="nav-link-text">Audio</span>
                        <span class="nav-link-badge" id="count-audio">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="documents">
                        <div class="nav-link-icon documents"><i class="fas fa-file-alt"></i></div>
                        <span class="nav-link-text">Documents</span>
                        <span class="nav-link-badge" id="count-documents">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="archives">
                        <div class="nav-link-icon archives"><i class="fas fa-file-archive"></i></div>
                        <span class="nav-link-text">Archives</span>
                        <span class="nav-link-badge" id="count-archives">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="code">
                        <div class="nav-link-icon code"><i class="fas fa-code"></i></div>
                        <span class="nav-link-text">Code</span>
                        <span class="nav-link-badge" id="count-code">0</span>
                    </a>
                    <a href="#" class="nav-link" data-category="other">
                        <div class="nav-link-icon other"><i class="fas fa-ellipsis-h"></i></div>
                        <span class="nav-link-text">Other</span>
                        <span class="nav-link-badge" id="count-other">0</span>
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="storage-widget">
                    <div class="storage-header">
                        <span class="storage-title">Storage Used</span>
                        <span class="storage-percentage" id="storage-percentage">0%</span>
                    </div>
                    <div class="storage-bar">
                        <div class="storage-bar-fill" id="storage-fill"></div>
                    </div>
                    <div class="storage-info">
                        <span id="storage-used">0 MB</span>
                        <span>of 500 MB</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-header">
                <div class="header-left">
                    <button class="mobile-menu-btn" id="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="page-info">
                        <h1 id="page-title">All Files</h1>
                        <p>Manage your database files</p>
                    </div>
                </div>

                <div class="header-center">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="search-input" placeholder="Search files...">
                    </div>
                </div>

                <div class="header-right">
                    <button class="header-btn" title="Notifications">
                        <i class="fas fa-bell"></i>
                    </button>
                    <button class="upload-btn" id="upload-btn">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span>Upload</span>
                    </button>
                </div>
            </header>

            <div class="content-wrapper">
                <div class="upload-zone" id="upload-zone">
                    <i class="fas fa-cloud-upload-alt upload-zone-icon"></i>
                    <h2>Drop files here to upload</h2>
                    <p>or click to browse from your computer</p>
                    <div class="upload-features">
                        <span><i class="fas fa-shield-alt"></i> Secure Upload</span>
                        <span><i class="fas fa-bolt"></i> Fast Processing</span>
                        <span><i class="fas fa-check-circle"></i> Auto-Categorize</span>
                    </div>
                    <input type="file" id="file-input" multiple hidden>
                </div>

                <div class="content-toolbar">
                    <div class="toolbar-left">
                        <h2 id="toolbar-title">All Files</h2>
                        <span class="file-count" id="file-count">0 files</span>
                    </div>
                    <div class="toolbar-right">
                        <div class="view-options">
                            <button class="view-btn active" id="grid-view-btn" title="Grid View">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button class="view-btn" id="list-view-btn" title="List View">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                        <select class="sort-select" id="sort-select">
                            <option value="date-desc">Newest First</option>
                            <option value="date-asc">Oldest First</option>
                            <option value="name-asc">Name (A-Z)</option>
                            <option value="name-desc">Name (Z-A)</option>
                            <option value="size-desc">Largest First</option>
                            <option value="size-asc">Smallest First</option>
                        </select>
                    </div>
                </div>

                <div class="files-grid grid-view" id="files-grid"></div>

                <div class="empty-state" id="empty-state">
                    <div class="empty-state-icon">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <h2>No files found</h2>
                    <p>Upload some files to get started with your S.T.E.M Pioneers Database</p>
                    <button class="empty-upload-btn" id="empty-upload-btn">
                        <i class="fas fa-plus"></i>
                        Upload Files
                    </button>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="modal-overlay"></div>

    <div class="file-modal" id="file-modal">
        <div class="modal-header">
            <div class="modal-title">
                <i class="fas fa-file" id="modal-icon"></i>
                <span id="modal-filename">filename.ext</span>
            </div>
            <div class="modal-actions">
                <button class="modal-btn" id="modal-favorite" title="Favorite">
                    <i class="far fa-star"></i>
                </button>
                <button class="modal-btn" id="modal-download" title="Download">
                    <i class="fas fa-download"></i>
                </button>
                <button class="modal-btn close" id="modal-close" title="Close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="modal-body">
            <div class="preview-section" id="preview-section"></div>
            <div class="details-section">
                <div class="details-content" id="details-content"></div>
                <div class="modal-footer">
                    <button class="action-btn secondary" id="modal-rename">
                        <i class="fas fa-edit"></i>
                        Rename
                    </button>
                    <button class="action-btn danger" id="modal-delete">
                        <i class="fas fa-trash-alt"></i>
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="context-menu" id="context-menu">
        <button class="context-item" data-action="preview">
            <i class="fas fa-eye"></i>
            <span>Preview</span>
        </button>
        <button class="context-item" data-action="download">
            <i class="fas fa-download"></i>
            <span>Download</span>
        </button>
        <button class="context-item" data-action="favorite">
            <i class="fas fa-star"></i>
            <span>Favorite</span>
        </button>
        <div class="context-divider"></div>
        <button class="context-item" data-action="rename">
            <i class="fas fa-edit"></i>
            <span>Rename</span>
        </button>
        <div class="context-divider"></div>
        <button class="context-item danger" data-action="delete">
            <i class="fas fa-trash-alt"></i>
            <span>Delete</span>
        </button>
    </div>

    <div class="toast-container" id="toast-container"></div>

    <div class="upload-panel" id="upload-panel">
        <div class="upload-panel-header">
            <div class="upload-panel-title">
                <i class="fas fa-cloud-upload-alt"></i>
                <span>Uploading Files</span>
            </div>
            <button class="upload-panel-close" id="upload-panel-close">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="upload-panel-body" id="upload-panel-body"></div>
    </div>

    <script>
    (function() {
        'use strict';

        // Database Class
        class STEMDatabase {
            constructor() {
                this.files = [];
                this.currentCategory = 'all';
                this.currentView = 'grid';
                this.currentSort = 'date-desc';
                this.maxStorage = 500 * 1024 * 1024;
                this.selectedFile = null;
                this.init();
            }

            init() {
                this.loadFilesFromServer();
                this.bindEvents();
                this.hideLoadingScreen();
                this.updateUI();
            }

            hideLoadingScreen() {
                setTimeout(function() {
                    document.getElementById('loading-screen').classList.add('hidden');
                }, 2200);
            }

            getFileCategory(type, name) {
                var ext = name.split('.').pop().toLowerCase();
                var categories = {
                    images: ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'svg', 'webp', 'ico', 'tiff', 'heic'],
                    videos: ['mp4', 'webm', 'avi', 'mov', 'wmv', 'flv', 'mkv', 'm4v', '3gp'],
                    audio: ['mp3', 'wav', 'ogg', 'flac', 'aac', 'm4a', 'wma'],
                    documents: ['pdf', 'doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'txt', 'rtf', 'odt', 'csv'],
                    archives: ['zip', 'rar', '7z', 'tar', 'gz', 'bz2'],
                    code: ['html', 'css', 'js', 'json', 'xml', 'php', 'py', 'java', 'cpp', 'c', 'h', 'ts', 'jsx', 'tsx', 'sql', 'rb', 'go', 'swift']
                };
                for (var cat in categories) {
                    if (categories[cat].indexOf(ext) !== -1) return cat;
                }
                return 'other';
            }

            getFileIcon(category) {
                var icons = {
                    images: 'fa-image',
                    videos: 'fa-play-circle',
                    audio: 'fa-headphones',
                    documents: 'fa-file-alt',
                    archives: 'fa-file-archive',
                    code: 'fa-code',
                    other: 'fa-file'
                };
                return icons[category] || 'fa-file';
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                var k = 1024;
                var sizes = ['Bytes', 'KB', 'MB', 'GB'];
                var i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            formatDate(timestamp) {
                var date = new Date(timestamp);
                var now = new Date();
                var diff = now - date;
                if (diff < 60000) return 'Just now';
                if (diff < 3600000) return Math.floor(diff / 60000) + ' min ago';
                if (diff < 86400000) return Math.floor(diff / 3600000) + ' hours ago';
                return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
            }

            saveToStorage() {
                try {
                    localStorage.setItem('stemDatabase', JSON.stringify(this.files));
                } catch (e) {
                    this.showToast('Storage Error', 'Could not save. Storage may be full.', 'error');
                }
            }

            loadFilesFromServer() {
    fetch('list.php')
        .then(res => res.json())
        .then(files => {
            this.files = files.map(file => ({
                id: file.name,
                name: file.name,
                size: file.size,
                type: '',
                category: this.getFileCategory('', file.name),
                dateAdded: Date.now(),
                favorite: false,
                url: file.url
            }));
            this.updateUI();
        }).catch(err => {
            console.error("Failed to load files:", err);
        });
}

            uploadFileToServer(file) {
    const formData = new FormData();
    formData.append("file", file);

    return fetch("upload.php", {
        method: "POST",
        body: formData
    }).then(res => {
        if (!res.ok) throw new Error("Failed to upload");
        return res.json();
    });
}

            deleteFile(id) {
                var file = this.files.find(function(f) { return f.id === id; });
                if (file && confirm('Delete "' + file.name + '"?')) {
                    this.files = this.files.filter(function(f) { return f.id !== id; });
                    this.saveToStorage();
                    this.updateUI();
                    this.closeModal();
                    this.showToast('File Deleted', file.name + ' has been removed', 'success');
                }
            }

            renameFile(id) {
                var file = this.files.find(function(f) { return f.id === id; });
                if (!file) return;
                var parts = file.name.split('.');
                var ext = parts.length > 1 ? '.' + parts.pop() : '';
                var currentName = parts.join('.');
                var newName = prompt('Enter new name:', currentName);
                if (newName && newName.trim()) {
                    file.name = newName.trim() + ext;
                    this.saveToStorage();
                    this.updateUI();
                    this.showToast('File Renamed', 'File renamed successfully', 'success');
                }
            }

            toggleFavorite(id) {
                var file = this.files.find(function(f) { return f.id === id; });
                if (file) {
                    file.favorite = !file.favorite;
                    this.saveToStorage();
                    this.updateUI();
                    this.showToast(file.favorite ? 'Added to Favorites' : 'Removed from Favorites', file.name, 'success');
                }
            }

            downloadFile(id) {
                var file = this.files.find(function(f) { return f.id === id; });
                if (!file) return;
                var link = document.createElement('a');
                link.href = file.url;
                link.download = file.name;
                link.click();
                this.showToast('Download Started', file.name, 'success');
            }

            getFilteredFiles() {
                var self = this;
                var filtered = this.files.slice();
                if (this.currentCategory === 'favorites') {
                    filtered = filtered.filter(function(f) { return f.favorite; });
                } else if (this.currentCategory !== 'all') {
                    filtered = filtered.filter(function(f) { return f.category === self.currentCategory; });
                }
                var searchTerm = document.getElementById('search-input').value.toLowerCase();
                if (searchTerm) {
                    filtered = filtered.filter(function(f) { return f.name.toLowerCase().indexOf(searchTerm) !== -1; });
                }
                var sort = this.currentSort;
                filtered.sort(function(a, b) {
                    switch (sort) {
                        case 'date-desc': return b.dateAdded - a.dateAdded;
                        case 'date-asc': return a.dateAdded - b.dateAdded;
                        case 'name-asc': return a.name.localeCompare(b.name);
                        case 'name-desc': return b.name.localeCompare(a.name);
                        case 'size-desc': return b.size - a.size;
                        case 'size-asc': return a.size - b.size;
                        default: return 0;
                    }
                });
                return filtered;
            }

            getTotalSize() {
                return this.files.reduce(function(total, file) { return total + file.size; }, 0);
            }

            getCategoryCounts() {
                var counts = { all: this.files.length, favorites: 0, images: 0, videos: 0, audio: 0, documents: 0, archives: 0, code: 0, other: 0 };
                this.files.forEach(function(file) {
                    counts[file.category]++;
                    if (file.favorite) counts.favorites++;
                });
                return counts;
            }

            updateUI() {
                this.renderFiles();
                this.updateCategoryCounts();
                this.updateStorageInfo();
                this.updateEmptyState();
            }

            renderFiles() {
                var self = this;
                var container = document.getElementById('files-grid');
                var files = this.getFilteredFiles();
                container.innerHTML = files.map(function(file) { return self.createFileCard(file); }).join('');
                document.getElementById('file-count').textContent = files.length + ' files';

                container.querySelectorAll('.file-card').forEach(function(card) {
                    var fileId = card.getAttribute('data-id');
                    card.addEventListener('click', function(e) {
                        if (!e.target.closest('.file-favorite')) {
                            self.openModal(fileId);
                        }
                    });
                    card.addEventListener('contextmenu', function(e) {
                        e.preventDefault();
                        self.showContextMenu(e, fileId);
                    });
                    var favBtn = card.querySelector('.file-favorite');
                    if (favBtn) {
                        favBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            self.toggleFavorite(fileId);
                        });
                    }
                });
            }

            createFileCard(file) {
                var icon = this.getFileIcon(file.category);
                var preview = '';
                if (file.category === 'images') {
    preview = '<img src="' + file.url + '" alt="' + file.name + '" loading="lazy">';
} else if (file.category === 'videos') {
    preview = '<video src="' + file.url + '" muted></video>';
} else {
                    preview = '<i class="fas ' + icon + ' file-icon ' + file.category + '"></i>';
                }
                var ext = file.name.split('.').pop().toUpperCase();
                return '<div class="file-card" data-id="' + file.id + '">' +
                    '<div class="file-preview">' + preview +
                    '<span class="file-badge">' + ext + '</span>' +
                    '<button class="file-favorite ' + (file.favorite ? 'active' : '') + '">' +
                    '<i class="' + (file.favorite ? 'fas' : 'far') + ' fa-star"></i></button></div>' +
                    '<div class="file-info"><div class="file-name" title="' + file.name + '">' + file.name + '</div>' +
                    '<div class="file-meta"><span class="file-size">' + this.formatFileSize(file.size) + '</span>' +
                    '<span class="file-date">' + this.formatDate(file.dateAdded) + '</span></div></div></div>';
            }

            updateCategoryCounts() {
                var counts = this.getCategoryCounts();
                for (var cat in counts) {
                    var el = document.getElementById('count-' + cat);
                    if (el) el.textContent = counts[cat];
                }
            }

            updateStorageInfo() {
                var totalSize = this.getTotalSize();
                var percentage = Math.min((totalSize / this.maxStorage) * 100, 100);
                document.getElementById('storage-fill').style.width = percentage + '%';
                document.getElementById('storage-percentage').textContent = percentage.toFixed(1) + '%';
                document.getElementById('storage-used').textContent = this.formatFileSize(totalSize);
            }

            updateEmptyState() {
                var files = this.getFilteredFiles();
                var grid = document.getElementById('files-grid');
                var empty = document.getElementById('empty-state');
                if (files.length === 0) {
                    grid.style.display = 'none';
                    empty.classList.add('show');
                } else {
                    grid.style.display = 'grid';
                    empty.classList.remove('show');
                }
            }

            openModal(fileId) {
                var file = this.files.find(function(f) { return f.id === fileId; });
                if (!file) return;
                this.selectedFile = file;
                var modal = document.getElementById('file-modal');
                var overlay = document.getElementById('modal-overlay');
                var preview = document.getElementById('preview-section');
                var details = document.getElementById('details-content');
                var icon = this.getFileIcon(file.category);

                document.getElementById('modal-filename').textContent = file.name;
                document.getElementById('modal-icon').className = 'fas ' + icon;
                document.getElementById('modal-favorite').innerHTML = '<i class="' + (file.favorite ? 'fas' : 'far') + ' fa-star"></i>';

                if (file.category === 'images') {
                    preview.innerHTML = '<img src="' + file.url + '" alt="' + file.name + '">';
                } else if (file.category === 'videos') {
                    preview.innerHTML = '<video src="' + file.url + '" controls autoplay></video>';
                } else if (file.category === 'audio') {
                    preview.innerHTML = '<div class="preview-placeholder"><i class="fas fa-headphones"></i>' +
                        '<audio src="' + file.url + '" controls autoplay style="margin-top:20px;width:100%;max-width:350px;"></audio></div>';
                } else {
                    preview.innerHTML = '<div class="preview-placeholder"><i class="fas ' + icon + '"></i>' +
                        '<p>Preview not available</p></div>';
                }

                details.innerHTML = '<div class="detail-group"><div class="detail-label">File Name</div>' +
                    '<div class="detail-value">' + file.name + '</div></div>' +
                    '<div class="detail-group"><div class="detail-label">Type</div>' +
                    '<div class="detail-value">' + (file.type || 'Unknown') + '</div></div>' +
                    '<div class="detail-group"><div class="detail-label">Size</div>' +
                    '<div class="detail-value">' + this.formatFileSize(file.size) + '</div></div>' +
                    '<div class="detail-group"><div class="detail-label">Category</div>' +
                    '<div class="detail-value">' + file.category.charAt(0).toUpperCase() + file.category.slice(1) + '</div></div>' +
                    '<div class="detail-group"><div class="detail-label">Date Added</div>' +
                    '<div class="detail-value">' + new Date(file.dateAdded).toLocaleString() + '</div></div>';

                modal.classList.add('show');
                overlay.classList.add('show');
            }

            closeModal() {
                var modal = document.getElementById('file-modal');
                var overlay = document.getElementById('modal-overlay');
                modal.classList.remove('show');
                overlay.classList.remove('show');
                var video = modal.querySelector('video');
                var audio = modal.querySelector('audio');
                if (video) video.pause();
                if (audio) audio.pause();
                this.selectedFile = null;
            }

            showContextMenu(e, fileId) {
                var menu = document.getElementById('context-menu');
                this.selectedFile = this.files.find(function(f) { return f.id === fileId; });
                menu.style.left = e.pageX + 'px';
                menu.style.top = e.pageY + 'px';
                menu.classList.add('show');
                var rect = menu.getBoundingClientRect();
                if (rect.right > window.innerWidth) menu.style.left = (e.pageX - rect.width) + 'px';
                if (rect.bottom > window.innerHeight) menu.style.top = (e.pageY - rect.height) + 'px';
            }

            hideContextMenu() {
                document.getElementById('context-menu').classList.remove('show');
            }

            handleFiles(fileList) {
                var self = this;
                var files = Array.prototype.slice.call(fileList);
                if (files.length === 0) return;
                var panel = document.getElementById('upload-panel');
                var body = document.getElementById('upload-panel-body');
                panel.classList.add('show');
                body.innerHTML = '';

                files.forEach(function(file, index) {
                    var item = document.createElement('div');
                    item.className = 'upload-item';
                    item.id = 'upload-' + index;
                    item.innerHTML = '<div class="upload-item-icon"><i class="fas ' + self.getFileIcon(self.getFileCategory(file.type, file.name)) + '"></i></div>' +
                        '<div class="upload-item-info"><div class="upload-item-name">' + file.name + '</div>' +
                        '<div class="upload-item-bar"><div class="upload-item-progress" style="width:0%"></div></div></div>' +
                        '<div class="upload-item-status"><i class="fas fa-spinner fa-spin"></i></div>';
                    body.appendChild(item);
                });

                this.uploadFiles(files);
            }

            uploadFiles(files) {
                var self = this;
                var index = 0;

                function uploadNext() {
                    if (index >= files.length) {
                        setTimeout(function() {
                            document.getElementById('upload-panel').classList.remove('show');
                            self.showToast('Upload Complete', files.length + ' file(s) uploaded', 'success');
                        }, 800);
                        return;
                    }

                    var file = files[index];
                    var item = document.getElementById('upload-' + index);
                    var progress = item.querySelector('.upload-item-progress');
                    var status = item.querySelector('.upload-item-status');
                    var p = 0;

                    var interval = setInterval(function() {
                        p += 20;
                        progress.style.width = p + '%';
                        if (p >= 100) {
                            clearInterval(interval);
                           self.uploadFileToServer(file).then(function(data) {
    self.files.push({
        id: data.name,
        name: data.name,
        size: data.size,
        type: '',
        category: self.getFileCategory('', data.name),
        dateAdded: Date.now(),
        favorite: false,
        url: data.url
    });
    self.updateUI();
    status.innerHTML = '<i class="fas fa-check"></i>';
    status.classList.add('success');
    index++;
    uploadNext();
}).catch(function() {
    status.innerHTML = '<i class="fas fa-times"></i>';
    status.classList.add('error');
    index++;
    uploadNext();
});
                        }
                    }, 80);
                }

                uploadNext();
            }

            showToast(title, message, type) {
                var container = document.getElementById('toast-container');
                var toast = document.createElement('div');
                toast.className = 'toast ' + type;
                var icons = { success: 'fa-check', error: 'fa-times', warning: 'fa-exclamation' };
                toast.innerHTML = '<div class="toast-icon"><i class="fas ' + (icons[type] || 'fa-info') + '"></i></div>' +
                    '<div class="toast-content"><div class="toast-title">' + title + '</div>' +
                    '<div class="toast-message">' + message + '</div></div>';
                container.appendChild(toast);
                setTimeout(function() {
                    toast.classList.add('hide');
                    setTimeout(function() { toast.remove(); }, 300);
                }, 3500);
            }

            bindEvents() {
                var self = this;

                // Navigation
                document.querySelectorAll('.nav-link').forEach(function(link) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        document.querySelectorAll('.nav-link').forEach(function(l) { l.classList.remove('active'); });
                        link.classList.add('active');
                        self.currentCategory = link.getAttribute('data-category');
                        var titleMap = { all: 'All Files', favorites: 'Favorites', images: 'Images', videos: 'Videos', audio: 'Audio', documents: 'Documents', archives: 'Archives', code: 'Code', other: 'Other' };
                        document.getElementById('page-title').textContent = titleMap[self.currentCategory] || 'All Files';
                        document.getElementById('toolbar-title').textContent = titleMap[self.currentCategory] || 'All Files';
                        self.updateUI();
                        if (window.innerWidth <= 1024) document.getElementById('sidebar').classList.remove('open');
                    });
                });

                // View Toggle
                document.getElementById('grid-view-btn').addEventListener('click', function() {
                    self.currentView = 'grid';
                    document.getElementById('files-grid').className = 'files-grid grid-view';
                    document.getElementById('grid-view-btn').classList.add('active');
                    document.getElementById('list-view-btn').classList.remove('active');
                });

                document.getElementById('list-view-btn').addEventListener('click', function() {
                    self.currentView = 'list';
                    document.getElementById('files-grid').className = 'files-grid list-view';
                    document.getElementById('list-view-btn').classList.add('active');
                    document.getElementById('grid-view-btn').classList.remove('active');
                });

                // Sort
                document.getElementById('sort-select').addEventListener('change', function(e) {
                    self.currentSort = e.target.value;
                    self.updateUI();
                });

                // Search
                document.getElementById('search-input').addEventListener('input', function() {
                    self.updateUI();
                });

                // Upload buttons
                document.getElementById('upload-btn').addEventListener('click', function() {
                    document.getElementById('file-input').click();
                });

                document.getElementById('empty-upload-btn').addEventListener('click', function() {
                    document.getElementById('file-input').click();
                });

                // File input
                document.getElementById('file-input').addEventListener('change', function(e) {
                    self.handleFiles(e.target.files);
                    e.target.value = '';
                });

                // Upload zone
                var uploadZone = document.getElementById('upload-zone');
                uploadZone.addEventListener('click', function() {
                    document.getElementById('file-input').click();
                });

                uploadZone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    uploadZone.classList.add('dragover');
                });

                uploadZone.addEventListener('dragleave', function() {
                    uploadZone.classList.remove('dragover');
                });

                uploadZone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    uploadZone.classList.remove('dragover');
                    self.handleFiles(e.dataTransfer.files);
                });

                // Modal
                document.getElementById('modal-close').addEventListener('click', function() {
                    self.closeModal();
                });

                document.getElementById('modal-overlay').addEventListener('click', function() {
                    self.closeModal();
                });

                document.getElementById('modal-download').addEventListener('click', function() {
                    if (self.selectedFile) self.downloadFile(self.selectedFile.id);
                });

                document.getElementById('modal-favorite').addEventListener('click', function() {
                    if (self.selectedFile) {
                        self.toggleFavorite(self.selectedFile.id);
                        var file = self.files.find(function(f) { return f.id === self.selectedFile.id; });
                        if (file) {
                            document.getElementById('modal-favorite').innerHTML = '<i class="' + (file.favorite ? 'fas' : 'far') + ' fa-star"></i>';
                        }
                    }
                });

                document.getElementById('modal-rename').addEventListener('click', function() {
                    if (self.selectedFile) {
                        self.renameFile(self.selectedFile.id);
                        self.openModal(self.selectedFile.id);  
                    }
                });
                document.getElementById('modal-delete').addEventListener('click', function() {
                    if (self.selectedFile) self.deleteFile(self.selectedFile.id);
                });
                // Context Menu
                document.addEventListener('click', function() {
                    self.hideContextMenu();
                });
                document.getElementById('context-menu').addEventListener('click', function(e) {
                    var action = e.target.closest('.context-item');
                    if (!action || !self.selectedFile) return;
                    var fileId = self.selectedFile.id;
                    var act = action.getAttribute('data-action');
                    switch (act) {
                        case 'preview': self.openModal(fileId); break;
                        case 'download': self.downloadFile(fileId); break;
                        case 'favorite': self.toggleFavorite(fileId); break;
                        case 'rename': self.renameFile(fileId); break;
                        case 'delete': self.deleteFile(fileId); break;
                    }
                    self.hideContextMenu();
                });
            }
        }
        window.stemDatabase = new STEMDatabase();
    })(); 
    </script>
</body>
</html>